<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Single Device Group Quiz</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
  h1 { text-align: center; }
  .setup, .quiz, .tally { max-width: 700px; margin: 20px auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); }
  input[type=text], input[type=number] { width: 100%; padding: 8px; margin: 5px 0; }
  button { padding: 10px 20px; margin: 5px 0; border: none; border-radius: 5px; background: #1976d2; color: white; cursor: pointer; }
  button.locked { background: #ccc; cursor: not-allowed; }
  .member-btn { display: inline-block; margin: 5px; }
  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background: #1976d2; color: white; }
  td.correct { background: #c8e6c9; }
</style>
</head>
<body>

<div class="setup">
  <h1>Group Setup</h1>
  <label>Group Number:</label>
  <input type="number" id="groupNumber" min="1" value="1">
  <label>Number of Members:</label>
  <input type="number" id="numMembers" min="1" value="3">
  <button onclick="createMemberInputs()">Create Members</button>
  <div id="memberInputs"></div>
</div>

<div class="quiz" style="display:none;">
  <h1>Quiz Question</h1>
  <p id="questionText">What is 2 + 2?</p>
  <p><strong>Who is answering now?</strong></p>
  <div id="memberButtons"></div>

  <div id="answerSection" style="display:none;">
    <label>Answer:</label>
    <input type="text" id="currentAnswer">
    <button onclick="submitAnswer()">Submit Answer</button>
  </div>
</div>

<div class="tally" style="display:none;">
  <h1>Tally Board</h1>
  <table id="tallyTable">
    <thead>
      <tr id="tallyHeader"></tr>
    </thead>
    <tbody id="tallyBody"></tbody>
  </table>
</div>

<script>
let groupNumber;
let members = [];
let currentMember = null;

// Step 1: Create member input fields
function createMemberInputs(){
  groupNumber = parseInt(document.getElementById('groupNumber').value);
  const numMembers = parseInt(document.getElementById('numMembers').value);
  let container = document.getElementById('memberInputs');
  container.innerHTML = '';
  members = [];
  for(let i=0; i<numMembers; i++){
    container.innerHTML += `<input type="text" placeholder="Member ${i+1} Name" id="member${i}"><br>`;
  }
  container.innerHTML += `<button onclick="saveMembers()">Save Members</button>`;
}

// Step 2: Save member names
function saveMembers(){
  const numMembers = parseInt(document.getElementById('numMembers').value);
  members = [];
  for(let i=0; i<numMembers; i++){
    const name = document.getElementById(`member${i}`).value || `Member${i+1}`;
    members.push({name: name, answer: null});
  }
  document.querySelector('.setup').style.display = 'none';
  document.querySelector('.quiz').style.display = 'block';
  document.querySelector('.tally').style.display = 'block';
  renderMemberButtons();
  renderTallyBoard();
}

// Step 3: Render member buttons
function renderMemberButtons(){
  const container = document.getElementById('memberButtons');
  container.innerHTML = '';
  members.forEach((m, idx) => {
    const btn = document.createElement('button');
    btn.textContent = m.name;
    btn.className = 'member-btn';
    if(m.answer !== null){
      btn.classList.add('locked');
      btn.disabled = true;
    }
    btn.onclick = () => selectMember(idx);
    container.appendChild(btn);
  });
}

// Step 4: Select member to answer
function selectMember(idx){
  currentMember = idx;
  document.getElementById('answerSection').style.display = 'block';
  document.getElementById('currentAnswer').focus();
}

// Step 5: Submit answer
function submitAnswer(){
  if(currentMember === null) return;
  const answer = document.getElementById('currentAnswer').value.trim();
  if(answer === '') return alert("Please enter an answer");
  members[currentMember].answer = answer;
  currentMember = null;
  document.getElementById('answerSection').style.display = 'none';
  document.getElementById('currentAnswer').value = '';
  renderMemberButtons();
  renderTallyBoard();
}

// Step 6: Render tally board
function renderTallyBoard(){
  const header = document.getElementById('tallyHeader');
  const body = document.getElementById('tallyBody');
  header.innerHTML = '<th>Member</th><th>Answer</th>';
  body.innerHTML = '';
  members.forEach(m => {
    const correct = m.answer === "4"; // hardcoded correct answer
    const row = `<tr>
      <td>${m.name}</td>
      <td class="${correct ? 'correct' : ''}">${m.answer || ''}</td>
    </tr>`;
    body.innerHTML += row;
  });
}
</script>
</body>
</html>
